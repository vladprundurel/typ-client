!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("chart.js"),require("rxjs"),require("lodash-es")):"function"==typeof define&&define.amd?define("@rinminase/ng-charts",["exports","@angular/core","chart.js","rxjs","lodash-es"],e):e(((t=t||self).rinminase=t.rinminase||{},t.rinminase["ng-charts"]={}),t.ng.core,t.chart_js,t.rxjs,t._)}(this,(function(t,e,r,o,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i=function(){return(i=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function a(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}var l=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]];function h(t,e,r){if("pie"===t||"doughnut"===t)return c(g(r));if("polarArea"===t)return{backgroundColor:(o=g(r)).map((function(t){return d(t,.6)})),borderColor:o.map((function(t){return d(t,1)})),hoverBackgroundColor:o.map((function(t){return d(t,.8)})),hoverBorderColor:o.map((function(t){return d(t,1)}))};var o;if("line"===t||"radar"===t)return function(t){return{backgroundColor:d(t,.4),borderColor:d(t,1),pointBackgroundColor:d(t,1),pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:d(t,.8)}}(f(e));if("bar"===t||"horizontalBar"===t)return function(t){return{backgroundColor:d(t,.6),borderColor:d(t,1),hoverBackgroundColor:d(t,.8),hoverBorderColor:d(t,1)}}(f(e));if("bubble"===t)return c(g(r));if("scatter"===t)return c(g(r));throw new Error("getColors - Unsupported chart type "+t)}function d(t,e){return"rgba("+t.concat(e).join(",")+")"}function u(t,e){return Math.floor(Math.random()*(e-t+1))+t}function c(t){return{backgroundColor:t.map((function(t){return d(t,.6)})),borderColor:t.map((function(){return"#fff"})),pointBackgroundColor:t.map((function(t){return d(t,1)})),pointBorderColor:t.map((function(){return"#fff"})),pointHoverBackgroundColor:t.map((function(t){return d(t,1)})),pointHoverBorderColor:t.map((function(t){return d(t,1)}))}}function p(){return[u(0,255),u(0,255),u(0,255)]}function f(t){return l[t]||p()}function g(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=l[r]||p();return e}var y,v=function(){function t(){this.pColorschemesOptions={},this.colorschemesOptions=new o.BehaviorSubject({})}return t.prototype.setColorschemesOptions=function(t){this.pColorschemesOptions=t,this.colorschemesOptions.next(t)},t.prototype.getColorschemesOptions=function(){return this.pColorschemesOptions},t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t=a([e.Injectable({providedIn:"root"})],t)}();!function(t){t[t.Default=0]="Default",t[t.Update=1]="Update",t[t.Refresh=2]="Refresh"}(y||(y={}));var b=function(){function t(t,r){this.element=t,this.themeService=r,this.options={},this.chartClick=new e.EventEmitter,this.chartHover=new e.EventEmitter,this.old={dataExists:!1,dataLength:0,datasetsExists:!1,datasetsLength:0,datasetsDataObjects:[],datasetsDataLengths:[],colorsExists:!1,colors:[],labelsExist:!1,labels:[],legendExists:!1,legend:{}},this.subs=[]}return t.registerPlugin=function(t){r.Chart.plugins.register(t)},t.unregisterPlugin=function(t){r.Chart.plugins.unregister(t)},t.prototype.ngOnInit=function(){var t=this;this.ctx=this.element.nativeElement.getContext("2d"),this.refresh(),this.subs.push(this.themeService.colorschemesOptions.subscribe((function(){return t.themeChanged()})))},t.prototype.themeChanged=function(){this.refresh()},t.prototype.ngDoCheck=function(){var t=this;if(this.chart){var e=y.Default,r=function(t){e=t>e?t:e};switch(!!this.data!==this.old.dataExists&&(this.propagateDataToDatasets(this.data),this.old.dataExists=!!this.data,r(y.Update)),this.data&&this.data.length!==this.old.dataLength&&(this.old.dataLength=this.data&&this.data.length||0,r(y.Update)),!!this.datasets!==this.old.datasetsExists&&(this.old.datasetsExists=!!this.datasets,r(y.Update)),this.datasets&&this.datasets.length!==this.old.datasetsLength&&(this.old.datasetsLength=this.datasets&&this.datasets.length||0,r(y.Update)),this.datasets&&this.datasets.filter((function(e,r){return e.data!==t.old.datasetsDataObjects[r]})).length&&(this.old.datasetsDataObjects=this.datasets.map((function(t){return t.data})),r(y.Update)),this.datasets&&this.datasets.filter((function(e,r){return e.data.length!==t.old.datasetsDataLengths[r]})).length&&(this.old.datasetsDataLengths=this.datasets.map((function(t){return t.data.length})),r(y.Update)),!!this.colors!==this.old.colorsExists&&(this.old.colorsExists=!!this.colors,this.updateColors(),r(y.Update)),this.colors&&this.colors.filter((function(e,r){return!t.colorsEqual(e,t.old.colors[r])})).length&&(this.old.colors=this.colors.map((function(e){return t.copyColor(e)})),this.updateColors(),r(y.Update)),!!this.labels!==this.old.labelsExist&&(this.old.labelsExist=!!this.labels,r(y.Update)),this.labels&&this.labels.filter((function(e,r){return!t.labelsEqual(e,t.old.labels[r])})).length&&(this.old.labels=this.labels.map((function(e){return t.copyLabel(e)})),r(y.Update)),!!this.options.legend!==this.old.legendExists&&(this.old.legendExists=!!this.options.legend,r(y.Refresh)),this.options.legend&&this.options.legend.position!==this.old.legend.position&&(this.old.legend.position=this.options.legend.position,r(y.Refresh)),e){case y.Default:break;case y.Update:this.update();break;case y.Refresh:this.refresh()}}},t.prototype.copyLabel=function(t){return Array.isArray(t)?function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(t):t},t.prototype.labelsEqual=function(t,e){return Array.isArray(t)===Array.isArray(e)&&(Array.isArray(t)||t===e)&&(!Array.isArray(t)||t.length===e.length)&&(!Array.isArray(t)||0===t.filter((function(t,r){return t!==e[r]})).length)},t.prototype.copyColor=function(t){return{backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderColor:t.borderColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,pointBorderColor:t.pointBorderColor,pointBackgroundColor:t.pointBackgroundColor,pointBorderWidth:t.pointBorderWidth,pointRadius:t.pointRadius,pointHoverRadius:t.pointHoverRadius,pointHitRadius:t.pointHitRadius,pointHoverBackgroundColor:t.pointHoverBackgroundColor,pointHoverBorderColor:t.pointHoverBorderColor,pointHoverBorderWidth:t.pointHoverBorderWidth,pointStyle:t.pointStyle,hoverBackgroundColor:t.hoverBackgroundColor,hoverBorderColor:t.hoverBorderColor,hoverBorderWidth:t.hoverBorderWidth}},t.prototype.colorsEqual=function(t,e){return!t==!e&&(!t||t.backgroundColor===e.backgroundColor&&t.borderWidth===e.borderWidth&&t.borderColor===e.borderColor&&t.borderCapStyle===e.borderCapStyle&&t.borderDash===e.borderDash&&t.borderDashOffset===e.borderDashOffset&&t.borderJoinStyle===e.borderJoinStyle&&t.pointBorderColor===e.pointBorderColor&&t.pointBackgroundColor===e.pointBackgroundColor&&t.pointBorderWidth===e.pointBorderWidth&&t.pointRadius===e.pointRadius&&t.pointHoverRadius===e.pointHoverRadius&&t.pointHitRadius===e.pointHitRadius&&t.pointHoverBackgroundColor===e.pointHoverBackgroundColor&&t.pointHoverBorderColor===e.pointHoverBorderColor&&t.pointHoverBorderWidth===e.pointHoverBorderWidth&&t.pointStyle===e.pointStyle&&t.hoverBackgroundColor===e.hoverBackgroundColor&&t.hoverBorderColor===e.hoverBorderColor&&t.hoverBorderWidth===e.hoverBorderWidth)},t.prototype.updateColors=function(){var t=this;this.datasets.forEach((function(e,r){t.colors&&t.colors[r]?Object.assign(e,t.colors[r]):Object.assign(e,h(t.chartType,r,e.data.length),i({},e))}))},t.prototype.ngOnChanges=function(t){var e=y.Default,r=function(t){e=t>e?t:e};switch(t.hasOwnProperty("data")&&t.data.currentValue&&(this.propagateDataToDatasets(t.data.currentValue),r(y.Update)),t.hasOwnProperty("datasets")&&t.datasets.currentValue&&(this.propagateDatasetsToData(t.datasets.currentValue),r(y.Update)),t.hasOwnProperty("labels")&&(this.chart&&(this.chart.data.labels=t.labels.currentValue),r(y.Update)),t.hasOwnProperty("legend")&&(this.chart&&(this.chart.config.options.legend.display=t.legend.currentValue,this.chart.generateLegend()),r(y.Update)),t.hasOwnProperty("options")&&r(y.Refresh),e){case y.Update:this.update();break;case y.Refresh:case y.Default:this.refresh()}},t.prototype.ngOnDestroy=function(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach((function(t){return t.unsubscribe()}))},t.prototype.update=function(t){if(this.chart)return this.chart.update(t)},t.prototype.hideDataset=function(t,e){this.chart.getDatasetMeta(t).hidden=e,this.chart.update()},t.prototype.isDatasetHidden=function(t){return this.chart.getDatasetMeta(t).hidden},t.prototype.toBase64Image=function(){return this.chart.toBase64Image()},t.prototype.getChartConfiguration=function(){var t=this,e=this.getDatasets(),r=Object.assign({},this.options);!1===this.legend&&(r.legend={display:!1}),r.hover=r.hover||{},r.hover.onHover||(r.hover.onHover=function(e,r){r&&!r.length||t.chartHover.emit({event:e,active:r})}),r.onClick||(r.onClick=function(e,r){t.chartClick.emit({event:e,active:r})});var o=this.smartMerge(r,this.themeService.getColorschemesOptions());return{type:this.chartType,data:{labels:this.labels||[],datasets:e},plugins:this.plugins,options:o}},t.prototype.getChartBuilder=function(t){var e=this.getChartConfiguration();return new r.Chart(t,e)},t.prototype.smartMerge=function(t,e,r){var o=this;if(void 0===r&&(r=0),0===r&&(t=n.cloneDeep(t)),Object.keys(e).forEach((function(n){if(Array.isArray(e[n])){var i=t[n];i&&i.forEach((function(t){o.smartMerge(t,e[n][0],r+1)}))}else"object"==typeof e[n]?(n in t||(t[n]={}),o.smartMerge(t[n],e[n],r+1)):t[n]=e[n]})),0===r)return t},t.prototype.isMultiLineLabel=function(t){return Array.isArray(t)},t.prototype.joinLabel=function(t){return t?this.isMultiLineLabel(t)?t.join(" "):t:null},t.prototype.propagateDatasetsToData=function(t){this.data=this.datasets.map((function(t){return t.data})),this.chart&&(this.chart.data.datasets=t),this.updateColors()},t.prototype.propagateDataToDatasets=function(t){var e=this;this.isMultiDataSet(t)?this.datasets&&t.length===this.datasets.length?this.datasets.forEach((function(e,r){e.data=t[r]})):(this.datasets=t.map((function(t,r){return{data:t,label:e.joinLabel(e.labels[r])||"Label "+r}})),this.chart&&(this.chart.data.datasets=this.datasets)):this.datasets?(this.datasets[0].data=t,this.datasets.splice(1)):(this.datasets=[{data:t}],this.chart&&(this.chart.data.datasets=this.datasets)),this.updateColors()},t.prototype.isMultiDataSet=function(t){return Array.isArray(t[0])},t.prototype.getDatasets=function(){if(!this.datasets&&!this.data)throw new Error("ng-charts configuration error, data or datasets field are required to render chart "+this.chartType);return this.datasets?(this.propagateDatasetsToData(this.datasets),this.datasets):this.data?(this.propagateDataToDatasets(this.data),this.datasets):void 0},t.prototype.refresh=function(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.ctx&&(this.chart=this.getChartBuilder(this.ctx))},t.ctorParameters=function(){return[{type:e.ElementRef},{type:v}]},a([e.Input()],t.prototype,"data",void 0),a([e.Input()],t.prototype,"datasets",void 0),a([e.Input()],t.prototype,"labels",void 0),a([e.Input()],t.prototype,"options",void 0),a([e.Input()],t.prototype,"chartType",void 0),a([e.Input()],t.prototype,"colors",void 0),a([e.Input()],t.prototype,"legend",void 0),a([e.Input()],t.prototype,"plugins",void 0),a([e.Output()],t.prototype,"chartClick",void 0),a([e.Output()],t.prototype,"chartHover",void 0),t=a([e.Directive({selector:"canvas[baseChart]",exportAs:"base-chart"})],t)}(),C=function(){function t(){}return t=a([e.NgModule({declarations:[b],imports:[],exports:[b]})],t)}();t.BaseChartDirective=b,t.ChartsModule=C,t.ThemeService=v,t.defaultColors=l,t.monkeyPatchChartJsLegend=function(){if("undefined"!=typeof Chart){var t=Chart.plugins.getAll().filter((function(t){return"legend"===t.id}))[0];t._element.prototype.fit=function(){var t=this,r=t.options,o=r.labels,i=r.display,a=t.ctx,s=e.options._parseFont(o),l=s.size,h=t.legendHitBoxes=[],d=t.minSize,u=t.isHorizontal();u?(d.width=t.maxWidth,d.height=i?10:0):(d.width=i?10:0,d.height=t.maxHeight);var c=function(t){return t.map((function(t){return a.measureText(t).width})).reduce((function(t,e){return e>t?e:t}),0)};if(i)if(a.font=s.string,u){var p=t.lineWidths=[0],f=t.lineHeights=[],g=0,y=0;a.textAlign="left",a.textBaseline="top",e.each(t.legendItems,(function(t,r){var i,s;e.isArray(t.text)?(i=c(t.text),s=l*t.text.length+o.padding):(i=a.measureText(t.text).width,s=l+o.padding),i+=n(o,l)+l/2,p[p.length-1]+i+2*o.padding>d.width&&(f.push(g),g=0,p[p.length-(r>0?0:1)]=0,y++),t.lineOrColumnIndex=y,s>g&&(g=s),h[r]={left:0,top:0,width:i,height:s},p[p.length-1]+=i+o.padding})),f.push(g),d.height+=f.reduce((function(t,e){return t+e}),0)}else{var v=o.padding,b=t.columnWidths=[],C=t.columnHeights=[],m=o.padding,x=0,B=0,D=0;e.each(t.legendItems,(function(t,r){var i,s;e.isArray(t.text)?(i=c(t.text),s=l*t.text.length):(i=a.measureText(t.text).width,s=l),i+=n(o,l)+l/2,B+l+2*v>d.height&&(m+=x+o.padding,b.push(x),C.push(B),x=0,B=0,D++),t.lineOrColumnIndex=D,x=Math.max(x,i),B+=s+v,h[r]={left:0,top:0,width:i,height:s}})),m+=x,b.push(x),C.push(B),d.width+=m}t.width=d.width,t.height=d.height},t._element.prototype.draw=function(){var t=this,i=t.options,a=i.labels,s=r.global,l=s.defaultColor,h=s.elements.line,d=t.height,u=t.columnHeights,c=t.columnWidths,p=t.width,f=t.lineWidths,g=t.lineHeights;if(i.display){var y,v=t.ctx,b=o(a.fontColor,s.defaultFontColor),C=e.options._parseFont(a),m=C.size;v.textAlign="left",v.textBaseline="middle",v.lineWidth=.5,v.strokeStyle=b,v.fillStyle=b,v.font=C.string;var x=n(a,m),B=t.legendHitBoxes,D=function(t,r,o,n){var i=m/2,a=x+i+t,s=r+i;e.isArray(o.text)?e.each(o.text,(function(t,e){var r=e*m;v.fillText(t,a,s+r)})):v.fillText(o.text,a,s),o.hidden&&(e.isArray(o.text)?function(t,e,r,o){v.beginPath(),v.lineWidth=2,v.moveTo(t,e),v.lineTo(t+r,e+o),v.moveTo(t,e+o),v.lineTo(t+r,e),v.stroke()}(a,s,n,(o.text.length-1)*(m-1)):function(t,e,r){v.beginPath(),v.lineWidth=2,v.moveTo(t,e),v.lineTo(t+r,e),v.stroke()}(a,s,n))},k=function(t,e){switch(i.align){case"start":return a.padding;case"end":return t-e;default:return(t-e+a.padding)/2}},O=t.isHorizontal();y=O?{x:t.left+k(p,f[0]),y:t.top+a.padding,line:0}:{x:t.left+a.padding,y:t.top+k(d,u[0]),line:0},e.each(t.legendItems,(function(r,n){var s,b,C;r.lineOrColumnIndex>y.line&&(O?(y.y+=g[y.line],y.line=r.lineOrColumnIndex,y.x=t.left+k(p,f[y.line])):(y.x+=c[y.line]+a.padding,y.line=r.lineOrColumnIndex,y.y=t.top+k(d,u[y.line]))),e.isArray(r.text)?(s=r.text.map((function(t){return v.measureText(t).width})).reduce((function(t,e){return e>t?e:t}),0),C=m/2*(r.text.length-1),b=m*r.text.length):(s=v.measureText(r.text).width,C=0,b=m);var w=x+m/2+s,S=y.x,H=y.y,A=O?Math.trunc((g[y.line]-B[n].height)/2):0;!function(t,r,n){if(!(isNaN(x)||x<=0)){v.save();var a=o(n.lineWidth,h.borderWidth);if(v.fillStyle=o(n.fillStyle,l),v.lineCap=o(n.lineCap,h.borderCapStyle),v.lineDashOffset=o(n.lineDashOffset,h.borderDashOffset),v.lineJoin=o(n.lineJoin,h.borderJoinStyle),v.lineWidth=a,v.strokeStyle=o(n.strokeStyle,l),v.setLineDash&&v.setLineDash(o(n.lineDash,h.borderDash)),i.labels&&i.labels.usePointStyle){var s=x*Math.SQRT2/2,d=t+x/2,u=r+m/2;e.canvas.drawPoint(v,n.pointStyle,s,d,u)}else 0!==a&&v.strokeRect(t,r,x,m),v.fillRect(t,r,x,m);v.restore()}}(S,H+C+A,r),B[n].left=S,B[n].top=H,D(S,H+A,r,s),O?y.x+=w+a.padding:y.y+=b+a.padding}))}};var e=Chart.helpers,r=Chart.defaults,o=e.valueOrDefault}else console.log("Chart not defined (guessing this is a universal build, and I don't know why this happens -- Aviad)");function n(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}},t.monkeyPatchChartJsTooltip=function(){if("undefined"!=typeof Chart){Chart.Tooltip.prototype.drawBody=function(r,o,n){var i,a=o.bodyFontSize,s=o.bodySpacing,l=o._bodyAlign,h=o.body,d=o.displayColors,u=o.labelColors,c=0,p=d?e(o,"left"):0;n.textAlign=l,n.textBaseline="top",n.font=t.fontString(a,o._bodyFontStyle,o._bodyFontFamily),r.x=e(o,l);var f=function(t){n.fillText(t,r.x+c,r.y),r.y+=a+s};n.fillStyle=o.bodyFontColor,t.each(o.beforeBody,f),c=d&&"right"!==l?"center"===l?a/2+1:a+2:0,t.each(h,(function(e,s){i=o.labelTextColors[s],n.fillStyle=i,t.each(e.before,f),d&&(n.fillStyle=o.legendColorBackground,n.fillRect(p,r.y,a,a),n.lineWidth=1,n.strokeStyle=u[s].borderColor,n.strokeRect(p,r.y,a,a),n.fillStyle=u[s].backgroundColor,n.fillRect(p+1,r.y+1,a-2,a-2),n.fillStyle=i),t.each(e.lines,f),t.each(e.after,f)})),c=0,t.each(o.afterBody,f),r.y-=s};var t=Chart.helpers}else console.log("Chart not defined (guessing this is a universal build, and I don't know why this happens -- Aviad)");function e(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=rinminase-ng-charts.umd.min.js.map